import cv2
import numpy as np
from matplotlib import pyplot as plt

def exe_to_png(path_exe):
    image = np.zeros((256, 256))
    i = j = 0
    with open(path_exe, 'rb') as f:
        current_byte = f.read(1)
        while current_byte != b'':
            # compute pixel color based on current byte
            pixel = int.from_bytes(current_byte, byteorder='big')
            # store pixel in image
            image[i, j] = pixel
            # update i, j indexes
            if i >= 255 and j >= 255: 
                print("[+] Max image dim exceeded")
                break
            elif j >= 255: 
                j = 0
                i += 1
            else:
                j += 1
            # get next byte
            current_byte = f.read(1)
    
    return image



if __name__ == "__main__":
    client_img = exe_to_png(r"./data/client")
    server_img = exe_to_png(r"./data/server")
    prova_img = exe_to_png(r"./data/provaMia")
    # create figure
    fig = plt.figure(figsize=(10, 7))
    
    rows = 2
    columns = 2
    
    # Adds a subplot at the 1st position
    fig.add_subplot(rows, columns, 1)
    
    # showing image
    plt.imshow(client_img)
    plt.axis('off')
    plt.title("First")
    
    # Adds a subplot at the 2nd position
    fig.add_subplot(rows, columns, 2)
    
    # showing image
    plt.imshow(server_img)
    plt.axis('off')
    plt.title("Second")
    
    # Adds a subplot at the 3rd position
    fig.add_subplot(rows, columns, 3)
    
    # showing image
    plt.imshow(prova_img)
    plt.axis('off')
    plt.title("Third")
  

    plt.show()
